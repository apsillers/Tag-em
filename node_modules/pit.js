module.exports = function(ensureLevelExists, getValidPosition, changeListener) {

    return function Pit(options) {
        return {
            id: options.id,
            x: options.x,
            y: options.y,
            z: options.z,
            symbol: '.',
            color: '#FFF',
	        onCollide: function(entity) {
		        ensureLevelExists(entity.z + 1);
		        entity.z += 1;
		        var foo = getValidPosition(entity.z);
		        entity.x = foo.x;
		        entity.y = foo.y;
		        this.symbol = "^";
		        changeListener.emit("change", [entity.z, entity.z-1], ["pos", "map"]);
	        }
        }
    }
}
